"use strict";var myMap,burger=document.querySelector("#burger"),overlay=document.querySelector("#overlay"),body=document.querySelector("body"),link=document.querySelectorAll(".overlay .menu__link");function toggleMenu(){burger.classList.toggle("burger--active"),overlay.classList.toggle("overlay--active"),body.classList.toggle("body--active")}burger.addEventListener("click",toggleMenu),link.forEach(function(e){e.addEventListener("click",toggleMenu)});var video,durationControl,soundControl,intervalControl,init=function(){myMap=new ymaps.Map("map",{center:[55.755864,37.617698],zoom:12,controls:[]});var e=new ymaps.Placemark([55.752004,37.576133],{},{draggable:!1,iconLayout:"default#image",iconImageHref:"./pics/pointer.svg",iconImageSize:[58,73],iconImageOffset:[-35,-52]});myMap.geoObjects.add(e),myMap.controls.add("zoomControl"),myMap.behaviors.disable("scrollZoom")},validateFields=(ymaps.ready(init),function(e,t){return t.forEach(function(e){e.removeClass("input-error"),""==e.val().trim()&&e.addClass("input-error")}),0==e.find(".input-error").length});function playStop(){document.querySelector(".player__button").classList.toggle("player__button--active"),document.querySelector(".player__button-duration").classList.toggle("player__button-duration--active"),durationControl.max=video.duration,video.paused?(video.play(),intervalControl=setInterval(updateDuration,1e3/66)):(video.pause(),clearInterval(intervalControl))}function updateDuration(){durationControl.value=video.currentTime}function stopInterval(){video.pause(),clearInterval(intervalControl)}function setVideoDuration(){video.paused?video.play():video.pause(),video.currentTime=durationControl.value,intervalControl=setInterval(updateDuration,1e3/66)}function changeSoundVolume(){video.volume=soundControl.value/10}function micVolume(){0==video.volume?(video.volume=soundLevel,soundControl.value=10*soundLevel):(soundLevel=video.volume,video.volume=0,soundControl.value=0)}$(".form").submit(function(e){e.preventDefault();var t=$(e.currentTarget),e=t.find("[name='name']"),o=t.find("[name='phone']"),n=t.find("[name='comment']"),i=t.find("[name='to']"),a=$("#modal"),r=a.find(".modal__content");a.removeClass("error-modal"),validateFields(t,[e,o,n,i])&&((e=$.ajax({url:"https://webdev-api.loftschool.com/sendmail",method:"post",data:{name:e.val(),phone:o.val(),comment:n.val(),to:i.val()}})).done(function(e){r.text(e.message),$(t)[0].reset()}),e.fail(function(e){e=e.responseJSON.message;r.text(e),a.addClass("error-modal")}),e.always(function(){Fancybox.show([{src:"#modal",type:"inline"}])}))}),$(".js-button").click(function(e){e.preventDefault(),Fancybox.close()}),document.addEventListener("DOMContentLoaded",function(e){(video=document.getElementById("video")).addEventListener("click",playStop);for(var t=document.querySelectorAll(".play"),o=0;o<t.length;o++)t[o].addEventListener("click",playStop);document.getElementById("mic-level").addEventListener("click",micVolume),(durationControl=document.getElementById("duration-range")).addEventListener("mousedown",stopInterval),durationControl.addEventListener("click",setVideoDuration),durationControl.min=0,durationControl.value=0,(soundControl=document.getElementById("sound-range")).addEventListener("mousedown",changeSoundVolume),soundControl.addEventListener("click",changeSoundVolume),soundControl.min=0,soundControl.max=10,soundControl.value=soundControl.max});var findWidth=function(e){var t=0,o=$(window).width(),n=e.closest(".products__list").find(".products__link"),n=n.width()*n.length,e=e.find(".products__info-container"),i=parseInt(e.css("padding-left")),e=parseInt(e.css("padding-right"));return{container:t=window.matchMedia("(max-width: 768px)").matches?o-n:500,textContainer:t-i-e}},closeContent=function(e){var t=e.find(".products__item"),e=e.find(".products__info");t.removeClass("products__item--active"),e.width(0)},openContent=function(e){var t=e.find(".products__info"),o=findWidth(e),n=e.find(".products__info-container");e.addClass("products__item--active"),t.width(o.container),n.width(o.textContainer)},sections=($(".products__link").on("click",function(e){e.preventDefault();var e=$(e.currentTarget),t=e.closest(".products__item"),o=t.hasClass("products__item--active"),e=e.closest(".products__list");o?closeContent(e):(closeContent(e),openContent(t))}),$(".products__info-button").on("click",function(e){e.preventDefault(),closeContent($(".products__list"))}),$("section")),main=$(".main"),inScroll=!1,showSection=(sections.first().addClass("active"),function(e){var t,o,n,i;0==inScroll&&(inScroll=!0,t=-100*e,o=sections.eq(e).attr("data-color"),n=$(".scroll"),i=$(".burger"),"black"==o?(n.addClass("scroll--black"),i.addClass("burger--black")):(n.removeClass("scroll--black"),i.removeClass("burger--black")),main.css({transform:"translateY(".concat(t,"%)")}),sections.eq(e).addClass("active").siblings().removeClass("active"),setTimeout(function(){inScroll=!1,n.find(".scroll__item").eq(e).addClass("scroll__item--active").siblings().removeClass("scroll__item--active")},1300))}),scrollDirection=function(e){var t=sections.filter(".active"),o=t.next(),t=t.prev();"next"==e&&o.length&&showSection(o.index()),"prev"==e&&t.length&&showSection(t.index())},slider=($(window).on("wheel",function(e){e=e.originalEvent.deltaY;0<e&&scrollDirection("next"),e<0&&scrollDirection("prev")}),$(window).on("keydown",function(e){var t=e.target.tagName.toLowerCase();if("input"!=t&&"textarea"!=t)switch(e.keyCode){case 38:scrollDirection("prev");break;case 40:scrollDirection("next")}}),$("[data-scroll]").on("click",function(e){e.preventDefault();e=$(e.currentTarget).attr("data-scroll"),e=$("[data-id=".concat(e,"]"));showSection(e.index())}),$(".goods__list").bxSlider({pager:!1,controls:!1})),openItem=($(".goods__slider-arrow--left").on("click",function(e){e.preventDefault(),slider.goToPrevSlide()}),$(".goods__slider-arrow--right").on("click",function(e){e.preventDefault(),slider.goToNextSlide()}),function(e){var e=e.closest(".team__item"),t=e.find(".team__job"),o=t.find(".team__job-container").height();e.addClass("team__item--active"),t.height(o)}),closeItems=function(e){var t=e.find(".team__job");e.find(".team__item").removeClass("team__item--active"),t.height(0)},findItem=($(".team__name").on("click",function(e){var e=$(e.currentTarget),t=e.closest(".team__list");e.closest(".team__item").hasClass("team__item--active")?closeItems(t):(closeItems(t),openItem(e))}),function(o){return $(".comments__item").filter(function(e,t){return $(t).attr("data-item")==o})});$(".users__link").on("click",function(e){e.preventDefault();var e=$(e.currentTarget),t=e.attr("data-link"),t=findItem(t),e=e.closest(".users__item");t.addClass("comments__item--active").siblings().removeClass("comments__item--active"),e.addClass("users__item--active").siblings().removeClass("users__item--active")});